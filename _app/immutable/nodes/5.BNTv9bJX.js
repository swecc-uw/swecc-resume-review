import{t as c,a as f}from"../chunks/QNH6tlMP.js";import{p as x,a as h,C as w,G as P,ao as b,a7 as k,D as m,B as _,x as a}from"../chunks/D5QiAU5i.js";import{d as C}from"../chunks/CW-MxM1t.js";import{i as E}from"../chunks/BEeDTpl5.js";import{m as U}from"../chunks/BOsJA4Ma.js";import{p as I,b as T}from"../chunks/C4ER6zCu.js";import{a as F}from"../chunks/Cfd7_EqS.js";var M=c('<div class="flex justify-center"><input type="file" class="text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" accept=".pdf"></div>');function j(e,r){x(r,!0);let l=I(r,"file",15);var t=M(),i=w(t);T(i,d=>l(d),()=>l()),P(t),f(e,t),h()}const W=async(e,r)=>await fetch(r,{method:"PUT",body:e}).then(t=>{if(console.log("Response:",t),!t.ok)throw new Error(`Failed to upload file: ${t.statusText}`);return t.url}),z=async(e,r)=>{const l=await F.post("/resume/upload/",{file_name:e,file_size:r/1024});if(l.status!==201)throw new Error(`Failed to get presigned URL: ${l.statusText}`);return{...l.data,presignedUrl:l.data.presigned_url}};var o=(e=>(e.PENDING="PENDING",e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.REJECTED="REJECTED",e))(o||{}),R=(e=>(e.SYSTEM="system",e.ERROR="error",e.ECHO="echo",e.LOG_LINE="log_line",e.LOGS_STARTED="logs_started",e.LOGS_STOPPED="logs_stopped",e.RESUME_REVIEWED="resume_reviewed",e))(R||{});const B=async(e,r,l)=>{if(!a(r))return;if(!a(r).files||a(r).files.length===0){alert("Please select a file to upload.");return}if(a(r).files.length>1){alert("Please select only one file to upload.");return}const t=a(r).files[0],{presignedUrl:i,key:d}=await z(t.name,t.size);await W(t,i),m(l,o.IN_PROGRESS,!0)};var J=c('<div class="text-gray-500">Waiting for upload...</div>'),V=c('<div class="flex items-center space-x-2"><div class="animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-500"></div> <span class="text-blue-500">Review in progress...</span></div>'),A=c('<div class="flex items-center space-x-2"><svg class="h-6 w-6 text-green-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg> <span class="text-green-500">Resume review completed successfully!</span></div>'),H=c('<div class="flex flex-col items-center justify-center min-h-screen space-y-4"><!> <button type="submit" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Upload</button> <!></div>');function ee(e,r){x(r,!0);let l=b(null),t=b(k(o.PENDING));U.subscribe(s=>{s.length>0&&s[s.length-1].type===R.RESUME_REVIEWED&&m(t,o.COMPLETED,!0)});var i=H(),d=w(i);j(d,{get file(){return a(l)},set file(s){m(l,s,!0)}});var g=_(d,2);g.__click=[B,l,t];var S=_(g,2);{var D=s=>{var p=J();f(s,p)},O=(s,p)=>{{var y=n=>{var u=V();f(n,u)},N=(n,u)=>{{var G=v=>{var L=A();f(v,L)};E(n,v=>{a(t)===o.COMPLETED&&v(G)},u)}};E(s,n=>{a(t)===o.IN_PROGRESS?n(y):n(N,!1)},p)}};E(S,s=>{a(t)===o.PENDING?s(D):s(O,!1)})}P(i),f(e,i),h()}C(["click"]);export{ee as component};
